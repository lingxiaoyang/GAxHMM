<pre class="code">
<span class="srcline"><span class="lineno"><a href="42,1" id="srcline1"> 1</a></span><span class="line"><span class="keyword">function</span> <span class="var type1" id="S2T12U3">Moverlapped</span> = foverlap_pitch(<span class="var type1" id="S3T12U6">Mgamma</span>,<span class="var type1" id="S4T12U7">Mphi</span>,<span class="var type1" id="S5T2U8">f0range_in_cents</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="42,2" id="srcline2"> 2</a></span><span class="line"><span class="mxinfo " id="T2:U5"><span class="var type1" id="S6T2U11">f0range</span>=<span class="mxinfo " id="T2:U7"><span class="var type1" id="S5T2U13">f0range_in_cents</span>/<span class="mxinfo " id="T2:U9">100</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="42,3" id="srcline3"> 3</a></span><span class="line"><span class="mxinfo " id="T2:U10"><span class="var type1" id="S7T2U17">max_i</span>=<span class="mxinfo " id="T2:U12">size(<span class="var type1" id="S3T12U20">Mgamma</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="42,4" id="srcline4"> 4</a></span><span class="line"><span class="mxinfo " id="T2:U14"><span class="var type1" id="S9T2U24">max_j</span>=<span class="mxinfo " id="T2:U16">size(<span class="var type1" id="S4T12U27">Mphi</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="42,5" id="srcline5"> 5</a></span><span class="line"><span class="mxinfo " id="T2:U18"><span class="var type1" id="S10T2U31">Nframes</span>= <span class="mxinfo " id="T2:U20">min(<span class="mxinfo " id="T2:U21">size(<span class="var type1" id="S3T12U36">Mgamma</span>,2)</span>,<span class="mxinfo " id="T2:U23">size(<span class="var type1" id="S4T12U40">Mphi</span>,2)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="42,6" id="srcline6"> 6</a></span><span class="line"><span class="mxinfo " id="T12:U25"><span class="var type1" id="S2T12U44">Moverlapped</span>=<span class="mxinfo " id="T12:U27">zeros(<span class="var type1" id="S7T2U47">max_i</span>,<span class="var type1" id="S9T2U48">max_j</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="42,7" id="srcline7"> 7</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S13T2U51">i</span>=<span class="mxinfo " id="T2:U31">1</span>:<span class="var type1" id="S7T2U54">max_i</span></span></span>
<span class="srcline"><span class="lineno"><a href="42,8" id="srcline8"> 8</a></span><span class="line">    <span class="keyword">for</span> <span class="var type1" id="S14T2U57">j</span>=<span class="mxinfo " id="T2:U34">1</span>:<span class="var type1" id="S9T2U60">max_j</span></span></span>
<span class="srcline"><span class="lineno"><a href="42,9" id="srcline9"> 9</a></span><span class="line">        <span class="keyword">for</span> <span class="var type1" id="S15T2U63">k</span>=<span class="mxinfo " id="T2:U37">1</span>:<span class="var type1" id="S10T2U66">Nframes</span></span></span>
<span class="srcline"><span class="lineno"><a href="42,10" id="srcline10">10</a></span><span class="line">            <span class="keyword">if</span> (<span class="mxinfo " id="T7:U39"><span class="mxinfo " id="T2:U40"><span class="var type1" id="S3T12U75">Mgamma</span>(<span class="var type1" id="S13T2U76">i</span>,<span class="var type1" id="S15T2U77">k</span>)</span>&gt;<span class="mxinfo " id="T2:U44">0</span></span>)&amp;&amp;(<span class="mxinfo " id="T7:U45"><span class="mxinfo " id="T2:U46"><span class="var type1" id="S4T12U82">Mphi</span>(<span class="var type1" id="S14T2U83">j</span>,<span class="var type1" id="S15T2U84">k</span>)</span>&gt;<span class="mxinfo " id="T2:U50">0</span></span>)&amp;&amp;(<span class="mxinfo " id="T7:U51"><span class="mxinfo " id="T2:U52"><span class="var type1" id="S3T12U89">Mgamma</span>(<span class="var type1" id="S13T2U90">i</span>,<span class="var type1" id="S15T2U91">k</span>)</span>&gt;=<span class="mxinfo " id="T2:U56"><span class="mxinfo " id="T2:U57"><span class="var type1" id="S4T12U94">Mphi</span>(<span class="var type1" id="S14T2U95">j</span>,<span class="var type1" id="S15T2U96">k</span>)</span>-<span class="var type1" id="S6T2U97">f0range</span></span></span>)&amp;&amp;(<span class="mxinfo " id="T7:U62"><span class="mxinfo " id="T2:U63"><span class="var type1" id="S3T12U101">Mgamma</span>(<span class="var type1" id="S13T2U102">i</span>,<span class="var type1" id="S15T2U103">k</span>)</span>&lt;=<span class="mxinfo " id="T2:U67"><span class="mxinfo " id="T2:U68"><span class="var type1" id="S4T12U106">Mphi</span>(<span class="var type1" id="S14T2U107">j</span>,<span class="var type1" id="S15T2U108">k</span>)</span>+<span class="var type1" id="S6T2U109">f0range</span></span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="42,11" id="srcline11">11</a></span><span class="line">                <span class="mxinfo " id="T2:U73"><span class="mxinfo " id="T2:U74"><span class="var type1" id="S2T12U113">Moverlapped</span>(<span class="var type1" id="S13T2U114">i</span>,<span class="var type1" id="S14T2U115">j</span>)</span>=<span class="mxinfo " id="T2:U78"><span class="mxinfo " id="T2:U79"><span class="var type1" id="S2T12U118">Moverlapped</span>(<span class="var type1" id="S13T2U119">i</span>,<span class="var type1" id="S14T2U120">j</span>)</span>+<span class="mxinfo " id="T2:U83">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="42,12" id="srcline12">12</a></span><span class="line">            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="42,13" id="srcline13">13</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="42,14" id="srcline14">14</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="42,15" id="srcline15">15</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="42,16" id="srcline16">16</a></span><span class="line"><span class="keyword">end</span></span></span>
</pre>
